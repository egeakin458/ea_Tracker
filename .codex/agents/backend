#!/bin/bash
set -e
cd "$(dirname "$0")/../../Backend" || exit 1
if [ -f ../secret.env ]; then
  export $(grep DEFAULT_CONNECTION ../secret.env | xargs) >/dev/null 2>&1 || true
fi
if [ -z "$DEFAULT_CONNECTION" ]; then
  echo "DEFAULT_CONNECTION not set" >&2
  exit 1
fi
dotnet restore
if [ -d Migrations ] && command -v dotnet-ef >/dev/null 2>&1; then
  dotnet ef database update
fi
dotnet build --nologo


